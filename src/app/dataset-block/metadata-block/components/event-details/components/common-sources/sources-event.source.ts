import { SourcesToolipsTexts } from "src/app/common/tooltips/sources.text";
import { EventRowDescriptor, EventRowDescriptorsByField } from "../../dynamic-events/dynamic-events.model";
import { StepTypePropertyComponent } from "../common/step-type-property/step-type-property.component";
import { SchemaPropertyComponent } from "../common/schema-property/schema-property.component";
import { SeparatorPropertyComponent } from "../common/separator-property/separator-property.component";
import { SimplePropertyComponent } from "../common/simple-property/simple-property.component";
import { MergeStrategyPropertyComponent } from "../common/merge-strategy-property/merge-strategy-property.component";
import { EnginePropertyComponent } from "../common/engine-property/engine-property.component";
import { SqlQueryViewerComponent } from "../common/sql-query-viewer/sql-query-viewer.component";
import { CardsPropertyComponent } from "../common/cards-property/cards-property.component";

export const SOURCES_EVENT_DESCRIPTORS: EventRowDescriptorsByField = {
    "ReadStepCsv.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_CSV,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-__typename",
    },
    "ReadStepCsv.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-schema",
    },
    "ReadStepCsv.separator": {
        label: "Separator:",
        tooltip: SourcesToolipsTexts.SEPARATOR,
        presentationComponent: SeparatorPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-separator",
    },
    "ReadStepCsv.quote": {
        label: "Quote character:",
        tooltip: SourcesToolipsTexts.QUOTE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-quote",
    },
    "ReadStepCsv.encoding": {
        label: "Encoding:",
        tooltip: SourcesToolipsTexts.ENCODING,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-encoding",
    },
    "ReadStepCsv.escape": {
        label: "Escape character:",
        tooltip: SourcesToolipsTexts.ESCAPE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-escape",
    },
    "ReadStepCsv.comment": {
        label: "Comment character:",
        tooltip: SourcesToolipsTexts.COMMENT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-comment",
    },
    "ReadStepCsv.enforceSchema": {
        label: "Enforce schema:",
        tooltip: SourcesToolipsTexts.ENFORCE_SCHEMA,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-enforceSchema",
    },
    "ReadStepCsv.inferSchema": {
        label: "Infer schema:",
        tooltip: SourcesToolipsTexts.INFER_SCHEMA,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-inferSchema",
    },
    "ReadStepCsv.header": {
        label: "Header:",
        tooltip: SourcesToolipsTexts.HEADER,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-header",
    },
    "ReadStepCsv.ignoreLeadingWhiteSpace": {
        label: "Ignore leading whitespace:",
        tooltip: SourcesToolipsTexts.IGNORE_LEADING_WHITESPACE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-ignoreLeadingWhiteSpace",
    },
    "ReadStepCsv.ignoreTrailingWhiteSpace": {
        label: "Ignore trailing whitespace:",
        tooltip: SourcesToolipsTexts.QUIGNORE_TRAILING_WHITESPACEOTE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-ignoreTrailingWhiteSpace",
    },
    "ReadStepCsv.nullValue": {
        label: "Null value:",
        tooltip: SourcesToolipsTexts.NULL_VALUE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-nullValue",
    },
    "ReadStepCsv.emptyValue": {
        label: "Empty value:",
        tooltip: SourcesToolipsTexts.EMPTY_VALUE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-emptyValue",
    },
    "ReadStepCsv.nanValue": {
        label: "Nan value:",
        tooltip: SourcesToolipsTexts.NAN_VALUE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-nanValue",
    },
    "ReadStepCsv.positiveInf": {
        label: "Possitive infinity:",
        tooltip: SourcesToolipsTexts.POSITIVE_INFINITY,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-positiveInf",
    },
    "ReadStepCsv.negativeInf": {
        label: "Negative infinity:",
        tooltip: SourcesToolipsTexts.NEGATIVE_INFINITY,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-negativeInf",
    },
    "ReadStepCsv.dateFormat": {
        label: "Date format:",
        tooltip: SourcesToolipsTexts.DATE_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-dateFormat",
    },
    "ReadStepCsv.multiLine": {
        label: "Multi line:",
        tooltip: SourcesToolipsTexts.MULTI_LINE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-multiLine",
    },
    "ReadStepCsv.timestampFormat": {
        label: "Timestamp format:",
        tooltip: SourcesToolipsTexts.TIMESTAMP_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepCsv-timestampFormat",
    },
    "MergeStrategyAppend.__typename": {
        label: "Strategy:",
        tooltip: SourcesToolipsTexts.MERGE_STRATEGY_APPEND,
        presentationComponent: MergeStrategyPropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategyAppend-__typename",
    },
    "TransformSql.engine": {
        label: "Engine:",
        tooltip: SourcesToolipsTexts.ENGINE,
        presentationComponent: EnginePropertyComponent,
        separateRowForValue: false,
        dataTestId: "transformSql-engine",
    },
    "TransformSql.queries": {
        label: "Queries:",
        tooltip: SourcesToolipsTexts.QUERIES,
        presentationComponent: SqlQueryViewerComponent,
        separateRowForValue: true,
        dataTestId: "transformSql-queries",
    },
    "MergeStrategyLedger.__typename": {
        label: "Strategy:",
        tooltip: SourcesToolipsTexts.MERGE_STRATEGY_LEDGER,
        presentationComponent: MergeStrategyPropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategyLedger-__typename",
    },
    "MergeStrategyLedger.primaryKey": {
        label: "Primary key:",
        tooltip: SourcesToolipsTexts.PRIMARY_KEYS,
        presentationComponent: CardsPropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategyLedger-primaryKey",
    },
    "ReadStepJson.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_JSON,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "ReadStepJson-__typename",
    },
    "ReadStepJson.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJson-schema",
    },
    "ReadStepJson.encoding": {
        label: "Encoding:",
        tooltip: SourcesToolipsTexts.READ_JSON_ENCODING,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJson-encoding",
    },
    "ReadStepJson.dateFormat": {
        label: "Date format:",
        tooltip: SourcesToolipsTexts.DATE_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJson-dateFormat",
    },
    "ReadStepNdGeoJson.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_ND_GEO_JSON,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepNdGeoJson-__typename",
    },
    "ReadStepJson.timestampFormat": {
        label: "Timestamp format:",
        tooltip: SourcesToolipsTexts.TIMESTAMP_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJson-timestampFormat",
    },
    "ReadStepJson.subPath": {
        label: "SubPath:",
        tooltip: SourcesToolipsTexts.READ_JSON_SUB_PATH,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJson-subPath",
    },
    "MergeStrategySnapshot.__typename": {
        label: "Strategy:",
        tooltip: SourcesToolipsTexts.SNAPSHOT_STRATEGY,
        presentationComponent: MergeStrategyPropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-__typename",
    },
    "MergeStrategySnapshot.primaryKey": {
        label: "Primary key:",
        tooltip: SourcesToolipsTexts.PRIMARY_KEYS,
        presentationComponent: CardsPropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-__primaryKey",
    },
    "MergeStrategySnapshot.compareColumns": {
        label: "Compare columns:",
        tooltip: SourcesToolipsTexts.COMPARE_COLUMNS,
        presentationComponent: CardsPropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-compareColumns",
    },
    "MergeStrategySnapshot.observationColumn": {
        label: "Observation column:",
        tooltip: SourcesToolipsTexts.OBSERVATION_COLUMN,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-observationColumn",
    },
    "MergeStrategySnapshot.obsvAdded": {
        label: "Observation added:",
        tooltip: SourcesToolipsTexts.OBSERVATION_ADDED,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-obsvAdded",
    },
    "MergeStrategySnapshot.obsvChanged": {
        label: "Observation changed:",
        tooltip: SourcesToolipsTexts.OBSERVATION_CHANGED,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-obsvChanged",
    },
    "MergeStrategySnapshot.obsvRemoved": {
        label: "Observation removed:",
        tooltip: SourcesToolipsTexts.OBSERVATION_REMOVED,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "mergeStrategySnapshot-obsvRemoved",
    },
    "ReadStepGeoJson.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_GEO_JSON,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepGeoJson-__typename",
    },
    "ReadStepGeoJson.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepGeoJson-schema",
    },
    "ReadStepEsriShapefile.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_ESRI_SHAPE_FILE,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepEsriShapefile-__typename",
    },
    "ReadStepEsriShapefile.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepEsriShapefile-schema",
    },
    "ReadStepEsriShapefile.subPath": {
        label: "Sub path:",
        tooltip: SourcesToolipsTexts.SUB_PATH,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepEsriShapefile-subPath",
    },
    "ReadStepParquet.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_PARQUET,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepParquet-__typename",
    },
    "ReadStepParquet.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepParquet-schema",
    },
    "ReadStepJsonLines.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_JSON_LINES,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-__typename",
    },
    "ReadStepNdJson.__typename": {
        label: "Type:",
        tooltip: SourcesToolipsTexts.READ_ND_JSON,
        presentationComponent: StepTypePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepNdJson-__typename",
    },
    "ReadStepJsonLines.primitivesAsString": {
        label: "Primitive as string:",
        tooltip: SourcesToolipsTexts.PRIMITIVE_AS_STRING,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-primitivesAsString",
    },
    "ReadStepJsonLines.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-schema",
    },
    "ReadStepNdGeoJson.schema": {
        label: "Schema:",
        tooltip: SourcesToolipsTexts.SCHEMA,
        presentationComponent: SchemaPropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepNdGeoJson-schema",
    },
    "ReadStepNdJson.dateFormat": {
        label: "Date format:",
        tooltip: SourcesToolipsTexts.DATE_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepNdJson-dateFormat",
    },
    "ReadStepNdJson.encoding": {
        label: "Encoding:",
        tooltip: SourcesToolipsTexts.READ_JSON_ENCODING,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepNdJson-encoding",
    },
    "ReadStepNdJson.timestampFormat": {
        label: "Timestamp format:",
        tooltip: SourcesToolipsTexts.TIMESTAMP_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepNdJson-timestampFormat",
    },
    "ReadStepJsonLines.dateFormat": {
        label: "Date format:",
        tooltip: SourcesToolipsTexts.DATE_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-dateFormat",
    },
    "ReadStepJsonLines.encoding": {
        label: "Encoding:",
        tooltip: SourcesToolipsTexts.ENCODING,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-encoding",
    },
    "ReadStepJsonLines.multiLine": {
        label: "Multi line:",
        tooltip: SourcesToolipsTexts.MULTI_LINE,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-multiLine",
    },
    "ReadStepJsonLines.timestampFormat": {
        label: "Timestamp format:",
        tooltip: SourcesToolipsTexts.TIMESTAMP_FORMAT,
        presentationComponent: SimplePropertyComponent,
        separateRowForValue: false,
        dataTestId: "readStepJsonLines-timestampFormat",
    },
};

export function getSourcesDescriptors(key: string): EventRowDescriptor {
    const data = key.split(".");
    const dataTestId = SOURCES_EVENT_DESCRIPTORS[`${data[1]}.${data[2]}`].dataTestId;
    const prefix = data[0][0].toLowerCase() + data[0].slice(1);
    return {
        ...SOURCES_EVENT_DESCRIPTORS[`${data[1]}.${data[2]}`],
        dataTestId: `${prefix}-${dataTestId ? dataTestId : "unknown-key"}`,
    };
}
