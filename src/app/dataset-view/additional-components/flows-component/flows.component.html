<ng-container *ngIf="tileWidgetData$ | async as flowConnection">
    <div class="search-result-container__content mb-20">
        <ng-container *ngIf="flowConnection.nodes.length; else noRuns">
            <div class="d-flex justify-content-between">
                <div class="mt-4">
                    <h2 class="title">{{ flowConnection.totalCount }} Dataset flow runs</h2>
                    <div>
                        <span class="text-muted"> Compute work associated with this dataset </span>
                    </div>
                </div>
                <div class="d-flex flex-column">
                    <div class="d-flex justify-content-end">
                        <button
                            class="btn-sm btn custom-edit"
                            aria-label="Show tasks options"
                            data-test-id="show-tasks-options"
                            title="Show options"
                            #menuTrigger="matMenuTrigger"
                            [matMenuTriggerFor]="menu"
                        >
                            <svg-icon name="show-options"></svg-icon>
                        </button>
                        <mat-menu #menu="matMenu" xPosition="before" [hasBackdrop]="true">
                            <button mat-menu-item (click)="updateNow()">Update now</button>
                            <mat-divider></mat-divider>
                            <button mat-menu-item (click)="updateSettings()">Update settings</button>
                            <mat-divider></mat-divider>
                            <button mat-menu-item [disabled]="true">Pause dataset updates</button>
                        </mat-menu>
                    </div>
                    <div class="mt-4 position-relative">
                        <input
                            class="form-control placeholder-padding-left d-inline custom-border w-300"
                            type="text"
                            name="search"
                            [(ngModel)]="searchFilter"
                            autocomplete="off"
                            placeholder="Search"
                            data-test-id="searchHash"
                            [disabled]="true"
                        />
                        <svg-icon name="search"></svg-icon>
                        <mat-icon
                            *ngIf="searchFilter"
                            (click)="refreshFilter()"
                            class="fs-5 d-inline position-absolute close-position"
                            data-test-id="clearSearch"
                            >close</mat-icon
                        >
                    </div>
                </div>
            </div>

            <div class="search-result-container__content my-4">
                <app-tile-base-widget [nodes]="flowConnection.nodes"></app-tile-base-widget>
            </div>

            <ng-container *ngIf="flowConnectionData$ | async as flowConnectionData">
                <app-flows-table
                    [nodes]="flowConnectionData.nodes"
                    [filterByStatus]="filterByStatus"
                    [filterByInitiator]="filterByInitiator"
                    [searchByAccountName]="searchByAccountName"
                    (filterByStatusChange)="onChangeFilterByStatus($event)"
                    (filterByInitiatorChange)="onChangeFilterByInitiator($event)"
                    (searchByAccountNameChange)="onSearchByAccountName($event)"
                ></app-flows-table>
                <div class="mt-50px">
                    <app-pagination
                        [currentPage]="flowConnectionData.pageInfo.currentPage + 1"
                        [pageInfo]="flowConnectionData.pageInfo"
                        (pageChangeEvent)="onPageChange($event)"
                    ></app-pagination>
                </div>
            </ng-container>
        </ng-container>
        <ng-template #noRuns>
            <p class="text-center">No flow runs</p>
        </ng-template>
    </div>
</ng-container>
