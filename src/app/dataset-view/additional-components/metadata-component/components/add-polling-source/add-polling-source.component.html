<div class="layout">
    <div class="mt-4">
        <div class="border border-1 mt-4 px-2 py-4 rounded-3">
            <form [formGroup]="pollingSourceForm">
                <ng-container *ngIf="currentStep === 1">
                    <div formGroupName="fetch">
                        <h2 class="text-center">Fetch</h2>
                        <div class="radio-group mt-4">
                            <div
                                class="input-container"
                                *ngFor="let step of fetchStepRadioData"
                            >
                                <input
                                    formControlName="kind"
                                    class="radio-input"
                                    type="radio"
                                    [id]="step.id"
                                    [value]="step.value"
                                />
                                <div class="radio-item">
                                    <mat-icon class="mat-icon">{{
                                        step.icon
                                    }}</mat-icon>
                                    <label [for]="step.id">{{
                                        step.label
                                    }}</label>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 row">
                            <div
                                *ngIf="
                                    fetchUrlForm.controls['kind'].value ===
                                    'url'
                                "
                            >
                                <div class="col-md-8 offset-md-2">
                                    <label for="url-name" class="form-label"
                                        >Url
                                        <span class="text-danger"
                                            >*</span
                                        ></label
                                    >
                                    <input
                                        class="form-control"
                                        id="url-name"
                                        placeholder="Please enter url..."
                                        formControlName="url"
                                        data-test-id="url-name"
                                    />
                                    <div
                                        *ngIf="
                                            !fetchUrlForm.controls['url']
                                                .valid &&
                                            fetchUrlForm.controls['url'].touched
                                        "
                                    >
                                        <div
                                            *ngIf="
                                                fetchUrlForm.controls['url']
                                                    .errors?.required
                                            "
                                            class="mt-1"
                                        >
                                            <span
                                                class="text-danger fs-12"
                                                data-test-id="error-url-name"
                                            >
                                                Url is required</span
                                            >
                                        </div>
                                        <div
                                            *ngIf="
                                                fetchUrlForm.controls['url']
                                                    .errors?.pattern
                                            "
                                            class="mt-1"
                                        >
                                            <span
                                                class="text-danger fs-12"
                                                data-test-id="error-url-format"
                                            >
                                                Url format is wrong</span
                                            >
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div
                                *ngIf="
                                    fetchUrlForm.controls['kind'].value ===
                                    'filesGlob'
                                "
                            >
                                filesGlob
                            </div>
                            <div
                                *ngIf="
                                    fetchUrlForm.controls['kind'].value ===
                                    'container'
                                "
                            >
                                container
                            </div>
                        </div>
                        <div class="d-flex mt-4 justify-content-center">
                            <button
                                class="btn btn-primary"
                                [disabled]="!fetchUrlForm.valid"
                                (click)="nextStep()"
                            >
                                Next
                            </button>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="currentStep === 2">
                    <div formGroupName="read">
                        <h2 class="text-center">Read</h2>
                        <div class="radio-group mt-4">
                            <div
                                class="input-container"
                                *ngFor="let step of readStepRadioData"
                            >
                                <input
                                    formControlName="kind"
                                    class="radio-input"
                                    type="radio"
                                    [id]="step.id"
                                    [value]="step.value"
                                />
                                <div class="radio-item">
                                    <mat-icon class="mat-icon">{{
                                        step.icon
                                    }}</mat-icon>
                                    <label [for]="step.id">{{
                                        step.label
                                    }}</label>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 row">
                            <div
                                *ngIf="
                                    readCsvForm.controls['kind'].value === 'csv'
                                "
                            >
                                <div class="col-md-8 offset-md-2">
                                    <label
                                        for="read-separator"
                                        class="form-label"
                                        >Separator
                                    </label>
                                    <input
                                        class="form-control"
                                        id="read-separator"
                                        placeholder="Please enter separator..."
                                        formControlName="separator"
                                        data-test-id="read-separator"
                                    />
                                </div>
                            </div>
                        </div>
                        <div class="d-flex mt-4 justify-content-center">
                            <button
                                class="btn btn-primary me-4"
                                (click)="prevStep()"
                            >
                                Previous
                            </button>
                            <button
                                class="btn btn-primary"
                                (click)="nextStep()"
                            >
                                Next
                            </button>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="currentStep === 3">
                    <div formGroupName="merge">
                        <h2 class="text-center">Merge</h2>
                        <div class="radio-group mt-4">
                            <div
                                class="input-container"
                                *ngFor="let step of mergeStepRadioData"
                            >
                                <input
                                    formControlName="kind"
                                    class="radio-input"
                                    type="radio"
                                    [id]="step.id"
                                    [value]="step.value"
                                />
                                <div class="radio-item">
                                    <mat-icon class="mat-icon">{{
                                        step.icon
                                    }}</mat-icon>
                                    <label [for]="step.id">{{
                                        step.label
                                    }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex mt-4 justify-content-center">
                            <button
                                class="btn btn-primary me-4"
                                (click)="prevStep()"
                            >
                                Previous
                            </button>

                            <button class="button-save" (click)="onSubmit()">
                                Save
                            </button>
                            <button
                                class="btn btn-outline-primary ms-4"
                                (click)="onEditYaml()"
                            >
                                Edit Yaml
                            </button>
                        </div>
                    </div>
                </ng-container>
            </form>
        </div>
    </div>

    <pre>{{ pollingSourceForm.value | json }}</pre>
</div>
