<div *ngIf="queries">
    <div class="text-center">
        <mat-icon class="fs-4 align-middle">query_stats</mat-icon>
        <label for="inputDatasets" class="form-label ps-1"> Queries</label>
    </div>
    <div class="d-flex justify-content-end mt-2 mb-3">
        <button (click)="addQuery()" class="button-style">+ Add query</button>
    </div>
    <div class="block-query mb-3" *ngFor="let query of queries; let i = index">
        <div>
            <div
                class="d-flex flex-row justify-content-between align-items-end"
            >
                <div>
                    <label for="alias-query" class="form-label">Alias</label>
                    <div class="d-flex align-items-center">
                        <input
                            class="form-control w-200"
                            id="alias-query"
                            [(ngModel)]="queries[i].alias"
                            [disabled]="isLastQuery(i)"
                        />
                        <span
                            *ngIf="isLastQuery(i)"
                            class="ms-4 badge bg-success"
                            >output</span
                        >
                    </div>
                </div>
                <div *ngIf="!isLastQuery(i)">
                    <button
                        class="no-button"
                        [disabled]="isBeforeLastQuery(i)"
                        (click)="swap(i, 1)"
                        title="Move down"
                    >
                        <mat-icon class="fs-4 hover">expand_more</mat-icon>
                    </button>
                    <button
                        class="no-button"
                        (click)="swap(i, -1)"
                        title="Move up"
                        [disabled]="isFirstQuery(i)"
                    >
                        <mat-icon class="fs-4 mx-2 hover">expand_less</mat-icon>
                    </button>
                    <button
                        class="no-button"
                        (click)="deleteQuery(i)"
                        title="Delete query"
                    >
                        <mat-icon class="fs-4 hover">delete</mat-icon>
                    </button>
                </div>
            </div>
            <div class="border border-1 mt-4 px-2 py-4">
                <ngx-monaco-editor
                    style="height: 300px"
                    [options]="sqlEditorOptions"
                    [(ngModel)]="queries[i].query"
                    ngDefaultControl
                    data-test-id="monaco-editor-modal"
                ></ngx-monaco-editor>
            </div>
        </div>
    </div>
</div>
