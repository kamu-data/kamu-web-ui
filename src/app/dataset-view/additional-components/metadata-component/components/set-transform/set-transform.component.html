<div class="text-center mt-4">
    <p class="fs-4">Set Transformation</p>
    <p class="text-muted">
        Defines a transformation that produces data in a derivative dataset.
    </p>
</div>
<div class="container-layout mt-4" id="container-layout">
    <div class="row">
        <div class="col">
            <div class="mb-3">
                <mat-icon class="fs-4 align-middle">input</mat-icon>
                <label for="inputDatasets" class="form-label ps-1">
                    Input datasets</label
                >
                <div class="d-flex flex-row align-items-center">
                    <input
                        type="text"
                        class="form-control w-300"
                        #searchDatasets
                        placeholder="Look up a dataset..."
                        [(ngModel)]="searchDataset"
                        [ngbTypeahead]="search"
                        [resultTemplate]="rt"
                        [inputFormatter]="formatter"
                        (selectItem)="onSelectItem($event)"
                    />
                    <button
                        (click)="clearSearch()"
                        mat-stroked-button
                        class="ms-2 button-clear"
                    >
                        Clear
                    </button>
                </div>
            </div>
            <ng-template #rt let-r="result" let-t="term">
                <div
                    class="d-flex flex-row justify-content-between"
                    [style.width.px]="searchDatasets.clientWidth - 28"
                >
                    <div>
                        <i class="bi bi-journal-album mr-2"></i>
                        <ngb-highlight
                            [result]="r.dataset.name"
                            [term]="t"
                        ></ngb-highlight>
                    </div>
                    <div
                        class="border rounded-1 flex-shrink-0 color-bg-tertiary px-1 f6 button-add color-text-tertiary ml-1"
                    >
                        Add
                        <span class="d-inline-block ml-1 v-align-middle"
                            ><i class="bi bi-arrow-return-left"></i
                        ></span>
                    </div>
                </div>
            </ng-template>
            <div class="mt-4">
                <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
                    <!-- This is the tree node template for leaf nodes -->
                    <mat-tree-node
                        *matTreeNodeDef="let node"
                        matTreeNodePadding
                    >
                        <!-- use a disabled button to provide padding for tree leaf -->
                        <button mat-icon-button disabled></button>
                        {{ node.name }}
                    </mat-tree-node>
                    <!-- This is the tree node template for expandable nodes -->
                    <mat-tree-node
                        *matTreeNodeDef="let node; when: hasChild"
                        matTreeNodePadding
                    >
                        <button
                            mat-icon-button
                            matTreeNodeToggle
                            [attr.aria-label]="'Toggle ' + node.name"
                        >
                            <mat-icon class="mat-icon-rtl-mirror">
                                {{
                                    treeControl.isExpanded(node)
                                        ? "expand_more"
                                        : "chevron_right"
                                }}
                            </mat-icon>
                        </button>
                        {{ node.name }}
                    </mat-tree-node>
                </mat-tree>
            </div>
        </div>
        <div class="col">Column2</div>
    </div>
</div>
