<table mat-table [dataSource]="tasks!">
    <!-- Description Column -->
    <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>
            <div class="d-inline-block text-muted">
                <button mat-button [matMenuTriggerFor]="statusMenu">
                    <span class="text-dark"> Status <span class="carpet"></span> </span>
                </button>
                <mat-menu #statusMenu="matMenu" xPosition="before" [hasBackdrop]="true">
                    <button mat-menu-item>Item 1</button>
                    <mat-divider></mat-divider>
                    <button mat-menu-item>Item 2</button>
                </mat-menu>
            </div>
        </th>
        <td mat-cell *matCellDef="let element" style="width: 50%">
            <div class="d-flex py-1">
                <mat-icon
                    *ngIf="element.status === TaskStatus.Finished && element.outcome === TaskOutcome.Success"
                    class="icon-status margin-top-5 completed-status"
                    >check_circle</mat-icon
                >
                <mat-icon *ngIf="element.status === TaskStatus.Running" class="icon-status margin-top-5 running-status"
                    >radio_button_checked</mat-icon
                >
                <mat-icon
                    *ngIf="element.status === TaskStatus.Finished && element.outcome === TaskOutcome.Failed"
                    class="icon-status margin-top-5 failed-status"
                    >dangerous</mat-icon
                >
                <div class="ms-1 py-2">
                    <span class="fw-500"> {{ element.description }} </span>
                    <span class="d-block fs-10"> {{ element.information }}</span>
                </div>
            </div>
        </td>
    </ng-container>

    <!-- Information Column -->
    <ng-container matColumnDef="information">
        <th mat-header-cell *matHeaderCellDef>
            <div class="text-dark mt-1 ps-4">Duration</div>
        </th>
        <td mat-cell *matCellDef="let element" style="width: 20%">
            <div class="d-flex flex-column">
                <div class="d-flex align-items-center">
                    <mat-icon class="icon-status text-muted">calendar_today</mat-icon>
                    <span class="ms-1 pt-1 text-small">
                        <app-display-time [data]="element.finishedAt" class="text-small no-wrap"></app-display-time
                    ></span>
                </div>

                <div class="d-flex align-items-center" *ngIf="element.status !== TaskStatus.Running">
                    <svg-icon name="timer" class="ps-1 pe-2 text-muted"></svg-icon>
                    <span class="text-small">
                        {{ durationTask(element.createdAt, element.finishedAt) }}
                    </span>
                </div>
            </div>
        </td>
    </ng-container>

    <!-- Creator Column -->
    <ng-container matColumnDef="creator">
        <th mat-header-cell *matHeaderCellDef>
            <div class="d-inline-block">
                <button mat-button [matMenuTriggerFor]="creatorMenu">
                    <span class="text-dark"> Created By <span class="carpet"></span> </span>
                </button>
                <mat-menu #creatorMenu="matMenu" xPosition="before" [hasBackdrop]="true">
                    <button mat-menu-item>Item 1</button>
                    <mat-divider></mat-divider>
                    <button mat-menu-item>Item 2</button>
                </mat-menu>
            </div>
        </th>
        <td mat-cell *matCellDef="let element" style="width: 20%">
            <div class="d-flex align-items-center ps-3">
                <img class="img-creator" [src]="'https://avatars.githubusercontent.com/u/11951648?v=4'" />
                <span class="ms-2 text-small"> {{ element.creator.accountName }}</span>
            </div>
        </td>
    </ng-container>

    <!-- Options Column -->
    <ng-container matColumnDef="options">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element" style="width: 10%">
            <div class="pe-2">
                <button mat-button [matMenuTriggerFor]="tableOptions"><svg-icon name="show-options"></svg-icon></button>
                <mat-menu #tableOptions="matMenu" xPosition="before" [hasBackdrop]="true">
                    <button mat-menu-item (click)="navigateToTaskDetaisView(element.taskId)">Details</button>
                    <mat-divider></mat-divider>
                    <button mat-menu-item>Cancel task</button>
                </mat-menu>
            </div>
        </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>

<div class="mt-100">
    <app-pagination [currentPage]="currentPage" [pageInfo]="pageInfo" data-test-id="pagination-tasks"></app-pagination>
</div>
