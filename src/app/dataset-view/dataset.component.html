<div class="app-main-container" role="main" data-test-id="dataset-view">
    <div class="app-content">
        <div class="d-flex">
            <div class="flex-auto min-width-0 width-fit mr-3">
                <h1
                        class="d-flex flex-wrap flex-items-center wb-break-word f3 text-normal align-items-center"
                >
                    <svg
                            aria-hidden="true"
                            height="16"
                            viewBox="0 0 16 16"
                            width="16"
                            data-view-component="true"
                            class="octicon octicon-repo color-fg-muted mr-2"
                    >
                        <path
                                fill-rule="evenodd"
                                d="M2 2.5A2.5 2.5 0 014.5 0h8.75a.75.75 0 01.75.75v12.5a.75.75 0 01-.75.75h-2.5a.75.75 0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75 0 01-1.072 1.05A2.495 2.495 0 012 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25 0 00.4.2l1.45-1.087a.25.25 0 01.3 0L8.6 15.7a.25.25 0 00.4-.2v-3.25a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25z"
                        ></path>
                    </svg>
                    <span class="author flex-self-stretch" itemprop="author">
                        <a
                                *ngIf="datasetName?.owner?.name"
                                class="url fn"
                                rel="author"
                                data-hovercard-type="organization"
                                (click)="showOwnerPage()"
                        >{{ datasetName.owner.name }}</a
                        >
                    </span>
                    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
                    <strong itemprop="name" class="mr-2 flex-self-stretch">
                        <a
                                *ngIf="datasetName?.owner?.name && datasetName?.name"
                                data-pjax="#repo-content-pjax-container"
                                [href]="
                                '/' +
                                datasetName.owner.name +
                                '/dataset-view?id=' +
                                datasetName.name +
                                '&type=overview'
                            "
                        >{{ datasetName.name }}</a
                        >
                    </strong>

                    <span></span
                    ><span class="label label--secondary v-align-middle mr-1"
                >Public</span
                >
                </h1>
            </div>

            <app-search-additional-buttons
                    [searchAdditionalButtonsData]="searchAdditionalButtonsData"
                    [isMinimizeSearchAdditionalButtons]="
                    isMinimizeSearchAdditionalButtons
                "
                    (searchAdditionalButtonsMethod)="
                    onClickSearchAdditionalButton($event)
                "
            >
            </app-search-additional-buttons>
        </div>
    </div>
    <div class="app-content">
        <div id="dataset-viewer">
            <div
                    class="search-header-container-block"
                    [style]="
                    isMinimizeSearchAdditionalButtons
                        ? 'grid-template-columns: 1fr 0.25fr; gap: 20px'
                        : ''
                "
            >
                <div class="datasetViewTypeToggleGroup">
                    <mat-button-toggle-group
                            name="datasetViewType"
                            aria-label="Dataset View Type"
                            [value]="datasetViewType"
                    >
                        <mat-button-toggle
                                value="overview"
                                [checked]="datasetViewTypeOverview"
                                (click)="onSearchDataset()"
                        >Overview
                        </mat-button-toggle>
                        <mat-button-toggle
                                value="data"
                                [checked]="datasetViewTypeData"
                                (click)="onSearchDataForDataset()"
                                disabled
                        >Data
                        </mat-button-toggle>
                        <mat-button-toggle
                                value="metadata"
                                [checked]="datasetViewTypeMetadata"
                                (click)="onSearchMetadata(1)"
                        >Metadata
                        </mat-button-toggle>
                        <mat-button-toggle
                                value="data"
                                [checked]="datasetViewTypeHistory"
                                (click)="onSearchDataForHistory()"
                                disabled
                        >History
                        </mat-button-toggle>
                        <mat-button-toggle
                                value="linage"
                                [checked]="datasetViewTypeLinage"
                                (click)="onSearchLinageDataset()"
                        >Linage
                        </mat-button-toggle>
                        <mat-button-toggle
                                value="discussions"
                                [checked]="datasetViewTypeDiscussions"
                                (click)="onSearchDiscussions()"
                                disabled
                        >Discussions
                        </mat-button-toggle>
                    </mat-button-toggle-group>
                </div>

                <ul class="nav searchAdditionalButtons__nav">
                    <li class="nav-item mr-2">
                        <div class="btnGroup-parent">
                            <button
                                    class="starred rounded-left-2 border-1 border-right-0 btn-sm btn btnGroup-item d-flex justify-content-center align-items-center"
                            >
                                <span class="d-inline mr-2">Download</span>
                            </button>
                            <button
                                    class="starred rounded-right-2 border-1 border border-dark btn-sm btn btnGroup-item d-flex justify-content-center align-items-center"
                                    mat-icon-button
                                    [matMenuTriggerFor]="menu2"
                                    aria-label="Example icon-button with a menu"
                                    data-test-id="searchAdditionalButtons"
                            >
                                <mat-icon>arrow_drop_down</mat-icon>
                            </button>

                            <mat-menu #menu2="matMenu">
                                <div
                                        class="SelectMenu-modal notifications-component-menu-modal"
                                >
                                    <header class="SelectMenu-header">
                                        <h3 class="SelectMenu-title">Copy</h3>
                                        <h3 class="SelectMenu-title">
                                            Download Zip
                                        </h3>
                                    </header>

                                    <div class="SelectMenu-list"></div>
                                </div>
                            </mat-menu>
                        </div>
                    </li>
                </ul>
            </div>
            <div [classList]="datasetViewTypeOverview ? 'dataset-result-container' : 'dataset-full-result-container'">
                <div
                        class="search-result-container__content"
                        id="searchResultContainerContent"
                >
                    <ng-template [ngIf]="datasetViewTypeLinage">
                        <ng-template
                                [ngIf]="
                                isAvailableLinageGraph &&
                                linageGraphLink.length !== 0
                            "
                        >
                            <app-linage-graph
                                    [view]="linageGraphView"
                                    [links]="linageGraphLink"
                                    [nodes]="linageGraphNodes"
                                    [clusters]="linageGraphClusters"
                                    (onClickNodeEvent)="onClickNode($event)"
                            ></app-linage-graph>
                        </ng-template>
                        <ng-template
                                [ngIf]="
                                !isAvailableLinageGraph &&
                                linageGraphLink.length === 0
                            "
                        >
                            <p>
                                The current dataset is root. Not enough data to
                                build the graph.
                            </p>
                        </ng-template>
                    </ng-template>

                    <ng-template [ngIf]="datasetViewTypeOverview">
                        <div class="d-flex flex-column flex-justify-between border-bottom pb-3 mb-3 position-relative">
                            <h2 class="box-title align-items-center pb-3">Description</h2>
                            <p>One Paragraph about data description goes here. You can also state why this data was collected. This description gives a detailed process on how the data was collected. It should describe the conditions under which the data was recorded and also the devices used to record the data.</p>
                            <div class="app-mat-chip" *ngIf="datasetInfo">
                                <mat-chip-list aria-label="Tags selection">
                                    <mat-chip (click)="selectTopic(datasetInfo.kind)">{{
                                        datasetInfo.kind
                                    }}</mat-chip>
                                    <mat-chip (click)="selectTopic('medicine')">medicine</mat-chip>
                                    <mat-chip (click)="selectTopic('covid')">covid</mat-chip>
                                    <mat-chip (click)="selectTopic('health')">health</mat-chip>
                                    <mat-chip (click)="selectTopic('covid19')">covid19</mat-chip>
                                </mat-chip-list>
                            </div>
                        </div>
                    </ng-template>

                    <ng-template
                            [ngIf]="
                            datasetViewTypeOverview || datasetViewTypeMetadata
                        "
                    >
                        <app-dynamic-table
                                [isResultQuantity]="tableData.isResultQuantity"
                                [isClickableRow]="tableData.isClickableRow"
                                [resultUnitText]="getResultUnitText()"
                                [isTableHeader]="tableData.isTableHeader"
                                [tableSource]="tableData.tableSource"
                                (onSelectDatasetEmit)="onSelectDataset($event)"
                        ></app-dynamic-table>
                    </ng-template>
                    <ng-template
                            [ngIf]="
                            datasetViewTypeMetadata &&
                            tableData.tableSource.length > 0
                        "
                    >
                        <app-pagination
                                [currentPage]="currentPage"
                                [pageInfo]="tableData.pageInfo"
                                (pageChangeEvent)="onPageChange($event)"
                        ></app-pagination>
                    </ng-template>

                    <ng-template [ngIf]="datasetViewTypeOverview">
                        <div id="file-readme-dataset-template-md" class="file my-4">
                        <div
                                class="file-header d-flex flex-md-items-center flex-items-start"
                        >
                            <div
                                    class="file-info pr-4 d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto align-items-center"
                            >
                                <span class="mr-2">
                                    <svg
                                            aria-hidden="true"
                                            height="16"
                                            viewBox="0 0 16 16"
                                            version="1.1"
                                            width="16"
                                            data-view-component="true"
                                            class="octicon octicon-code-square color-fg-muted"
                                    >
                                        <path
                                                fill-rule="evenodd"
                                                d="M1.75 1.5a.25.25 0 00-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 00.25-.25V1.75a.25.25 0 00-.25-.25H1.75zM0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0114.25 16H1.75A1.75 1.75 0 010 14.25V1.75zm9.22 3.72a.75.75 0 000 1.06L10.69 8 9.22 9.47a.75.75 0 101.06 1.06l2-2a.75.75 0 000-1.06l-2-2a.75.75 0 00-1.06 0zM6.78 6.53a.75.75 0 00-1.06-1.06l-2 2a.75.75 0 000 1.06l2 2a.75.75 0 101.06-1.06L5.31 8l1.47-1.47z"
                                        ></path>
                                    </svg>
                                </span>
                                <h2 class="box-title align-items-center">
                                    <a
                                            href="#readme"
                                            data-view-component="true"
                                            class="link--primary"
                                    >README-dataset-template.md</a
                                    >
                                </h2>
                            </div>
                            <button class="starred rounded-2 btn-sm btn btnGroup-item d-flex justify-content-center align-items-center"
                                    aria-label="Edit this file" data-hotkey="e" data-disable-with=""
                            (click)="toggleReadmeView()">
                                <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16"
                                     data-view-component="true" class="octicon octicon-pencil">
                                    <path fill-rule="evenodd"
                                          d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="file-content">
                            <ng-template [ngIf]="isMarkdownEditView">
                                <textarea class="variable-textarea"
                                        [(ngModel)]="markdown"
                                ></textarea>
                            </ng-template>
                            <ng-template [ngIf]="!isMarkdownEditView">
                                <markdown
                                    class="variable-binding"
                                    [data]="markdown"></markdown>
                            </ng-template>
                        </div>
                    </div>
                    </ng-template>
                </div>
                <div class="card" *ngIf="datasetViewTypeOverview">
                    <nav class="navbar navbar-expand">
                        <div class="navbar-nav dataset-info">
                            <ng-template [ngIf]="datasetInfo">
                                <div>
                                    <b>Kind:</b>
                                    <p>
                                        {{ datasetInfo.kind }}
                                    </p>
                                </div>
                                <div>
                                    <b>Verified Badge:</b>
                                    <p>...</p>
                                </div>
                                <div>
                                    <b>Visibility:</b>
                                    <p>Public</p>
                                </div>
                                <div *ngIf="datasetInfo.metadata">
                                    <b>License:</b>
                                    <p>
                                        {{
                                        momentConverDatetoLocalWithFormat(
                                            datasetInfo.metadata
                                                .currentWatermark
                                        )
                                        }}
                                    </p>
                                </div>
                                <div>
                                    <b>Estimated Size:</b>
                                    <p>
                                        {{
                                        datasetInfo.estimatedSize
                                            | number: "1.0-0"
                                        }}
                                    </p>
                                </div>
                                <div>
                                    <b>Num Records Total:</b>
                                    <p>
                                        {{
                                        datasetInfo.numRecordsTotal
                                            | number: "1.0-0"
                                        }}
                                    </p>
                                </div>
                                <div>
                                    <b>Created At:</b>
                                    <p>
                                        {{
                                        momentConverDatetoLocalWithFormat(
                                            datasetInfo.createdAt
                                        )
                                        }}
                                    </p>
                                </div>
                                <div>
                                    <b>Last Updated At:</b>
                                    <p>
                                        {{
                                        momentConverDatetoLocalWithFormat(
                                            datasetInfo.lastUpdatedAt
                                        )
                                        }}
                                    </p>
                                </div>
                            </ng-template>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>
